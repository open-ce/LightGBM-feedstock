From 068c742cee806aea85c5ff158cd8c711d6228e16 Mon Sep 17 00:00:00 2001
From: Archana-Shinde1 <archana.shinde1@ibm.com>
Date: Tue, 8 Apr 2025 04:14:29 +0000
Subject: [PATCH] Fixed CVE-2024-43598

---
 src/network/linkers_socket.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/network/linkers_socket.cpp b/src/network/linkers_socket.cpp
index 03c73755..e74ccb39 100644
--- a/src/network/linkers_socket.cpp
+++ b/src/network/linkers_socket.cpp
@@ -157,6 +157,9 @@ void Linkers::ListenThread(int incoming_cnt) {
     }
     int* ptr_in_rank = reinterpret_cast<int*>(buffer);
     int in_rank = *ptr_in_rank;
+    if (in_rank < 0 || in_rank >= num_machines_) {
+      Log::Fatal("Invalid rank %d found during initialization of linkers. The world size is %d.", in_rank, num_machines_);
+    }
     // add new socket
     SetLinker(in_rank, handler);
     ++connected_cnt;
-- 
2.40.1

